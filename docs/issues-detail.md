# Voice Transcribe Chrome Extension - 詳細Issue一覧

## Issue #1: プロジェクトセットアップと設定

### 1-1: Docker開発環境の構築
- Dockerfileの作成（Node.js 20, pnpm環境）
- docker-compose.ymlの作成
- VS Code Dev Container設定
- ボリュームマウントの設定

### 1-2: Node.jsプロジェクトの初期化
- pnpm initによるpackage.json作成
- 必要な依存関係の定義
- TypeScript設定（tsconfig.json）
- ESLint/Prettier設定

### 1-3: Chrome拡張機能Manifest V3の設定
- manifest.jsonの作成
- 必要な権限の定義（microphone, storage, scripting）
- content_scripts設定
- web_accessible_resources設定

### 1-4: ビルドシステムの構築
- Viteの設定（chrome-extension対応）
- ビルドスクリプトの作成
- ソースマップ設定
- 開発/本番ビルドの分離

### 1-5: 開発環境ドキュメントの作成
- README.mdの更新
- 開発環境セットアップ手順
- 拡張機能のインストール手順
- デバッグ方法のドキュメント

## Issue #2: マイク音声キャプチャ機能

### 2-1: getUserMedia権限取得の実装
- iframeを使った権限取得フローの実装
- 権限状態の管理
- 権限エラーハンドリング
- 再取得フローの実装

### 2-2: 音声ストリーム処理の実装
- MediaRecorderの設定と初期化
- 音声フォーマットの設定（WebM Opus）
- チャンクサイズとタイムスライスの調整
- バッファリング戦略の実装

### 2-3: 録音制御機能の実装
- start/stop/pauseの実装
- 録音状態の管理
- UI連携のためのイベント発火
- リソースのクリーンアップ処理

### 2-4: 音声データ変換処理
- 音声データのBlob変換
- base64エンコーディング（必要に応じて）
- データサイズの最適化
- メタデータの付与

## Issue #3: OpenAI GPT-4o-Transcribe API統合

### 3-1: WebSocket接続の実装
- WebSocket接続管理クラスの作成
- 自動再接続機能
- ハートビート実装
- 接続状態の監視

### 3-2: ストリーミング音声送信の実装
- 音声チャンクの送信処理
- バックプレッシャー対応
- 送信キューの管理
- プロトコルメッセージの実装

### 3-3: REST APIフォールバックの実装
- 音声ファイルのアップロード処理
- チャンク分割ロジック
- 進捗管理
- 結果のマージ処理

### 3-4: APIキー管理システム
- セキュアなキー保存（chrome.storage.local）
- キー検証機能
- 環境変数サポート
- UIでのキー入力機能

### 3-5: API エラーハンドリング
- レート制限対応
- タイムアウト処理
- エラーリトライロジック
- ユーザーへのエラー通知

## Issue #4: Notion Web UI統合

### 4-1: Notion DOM構造の調査と対応
- contenteditable要素の特定
- ブロック構造の理解
- React/仮想DOMの考慮
- 動的要素への対応

### 4-2: テキスト挿入メカニズムの実装
- execCommand APIの使用
- カスタムイベントの発火
- Undo/Redo対応
- フォーマット保持

### 4-3: カーソル位置管理
- Selection APIの活用
- カーソル位置の保存と復元
- 複数ブロック間の移動
- フォーカス管理

### 4-4: リアルタイム挿入最適化
- テキストバッファリング
- 挿入頻度の調整
- パフォーマンス最適化
- スムーズなUX実現

## Issue #5: 要約機能

### 5-1: 要約API統合
- GPT-4/GPT-3.5-turbo APIの実装
- プロンプトエンジニアリング
- トークン数管理
- コスト計算機能

### 5-2: 要約タイミング制御
- 自動要約トリガー
- 手動要約ボタン
- タイマーベース要約
- 文字数ベース要約

### 5-3: 長文処理戦略
- テキスト分割アルゴリズム
- 階層的要約
- コンテキスト保持
- 要約品質の確保

## Issue #6: ユーザーインターフェース

### 6-1: ポップアップUI実装
- React/Preactでの実装
- UIコンポーネント設計
- スタイリング（Tailwind CSS）
- レスポンシブデザイン

### 6-2: 状態管理システム
- グローバル状態管理（Zustand/Jotai）
- 永続化対応
- 状態同期メカニズム
- デバッグツール統合

### 6-3: メッセージング実装
- chrome.runtime API活用
- ポート接続管理
- メッセージタイプ定義
- エラー境界実装

### 6-4: フィードバックシステム
- トースト通知
- プログレス表示
- エラーメッセージ
- 音声レベルメーター

## Issue #7: ファイルアップロード機能

### 7-1: ファイル選択UI
- ドラッグ&ドロップ対応
- ファイルタイプ検証
- プレビュー機能
- 複数ファイル対応準備

### 7-2: ファイル処理エンジン
- ファイルサイズ検証
- 音声抽出（動画ファイルから）
- フォーマット変換
- メタデータ抽出

### 7-3: 大容量ファイル対応
- ファイル分割アルゴリズム
- チャンク管理
- 進捗追跡
- 中断/再開機能

## Issue #8: ドキュメンテーションとリリース

### 8-1: ユーザードキュメント
- 使い方ガイド
- FAQ作成
- トラブルシューティング
- ビデオチュートリアル準備

### 8-2: 開発者ドキュメント
- APIドキュメント
- アーキテクチャ図
- コントリビューションガイド
- コードスタイルガイド

### 8-3: テスト戦略
- ユニットテスト実装
- E2Eテスト（Puppeteer）
- 手動テストチェックリスト
- CI/CDパイプライン

### 8-4: Chrome Web Storeリリース準備
- プライバシーポリシー作成
- 拡張機能の説明文
- スクリーンショット準備
- 審査対応ドキュメント